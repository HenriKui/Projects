<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>bdaproject</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="BDAproject_files/libs/clipboard/clipboard.min.js"></script>
<script src="BDAproject_files/libs/quarto-html/quarto.js"></script>
<script src="BDAproject_files/libs/quarto-html/popper.min.js"></script>
<script src="BDAproject_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="BDAproject_files/libs/quarto-html/anchor.min.js"></script>
<link href="BDAproject_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="BDAproject_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="BDAproject_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="BDAproject_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="BDAproject_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#forming-bayesian-regression-models-using-stan" id="toc-forming-bayesian-regression-models-using-stan" class="nav-link active" data-scroll-target="#forming-bayesian-regression-models-using-stan"><span class="header-section-number">1</span> Forming bayesian regression models using Stan</a></li>
  <li><a href="#posterior-predictive-checking-and-model-analysis" id="toc-posterior-predictive-checking-and-model-analysis" class="nav-link" data-scroll-target="#posterior-predictive-checking-and-model-analysis"><span class="header-section-number">2</span> Posterior predictive checking and model analysis</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="BDAproject.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content"><div class="quarto-title-block"><div class="quarto-title-tools-only"><h1></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>



<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(bayesplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is bayesplot version 1.10.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Online documentation and vignettes at mc-stan.org/bayesplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- bayesplot theme set to bayesplot::theme_default()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>   * Does _not_ affect other ggplot2 plots</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>   * See ?bayesplot_theme_set for details on theme setting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(cmdstanr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is cmdstanr version 0.6.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- CmdStan path: /Users/henri.kuivasniemi/.cmdstan/cmdstan-2.33.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- CmdStan version: 2.33.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">library</span>(ggdist) <span class="co"># for stat_dotsinterval</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">library</span>(posterior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is posterior version 1.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'posterior'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:bayesplot':

    rhat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    mad, sd, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    %in%, match</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">library</span>(brms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading 'brms' package (version 2.20.4). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'brms'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggdist':

    dstudent_t, pstudent_t, qstudent_t, rstudent_t</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:bayesplot':

    rhat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    ar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">library</span>(Metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Metrics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggdist':

    ll</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">library</span>(bayestestR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'bayestestR'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Metrics':

    auc</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggdist':

    hdi</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Globally specfiy cmdstan backend for brms</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co"># Tell brms to cache results if possible</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="fu">options</span>(<span class="at">brms.file_refit=</span><span class="st">"on_change"</span>)</span>
<span id="cb38-5"><a href="#cb38-5"></a></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co"># Set more readable themes with bigger font for plotting packages</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb38-8"><a href="#cb38-8"></a>bayesplot<span class="sc">::</span><span class="fu">bayesplot_theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"frogs.csv"</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a>sampled_data <span class="ot">&lt;-</span> data[<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="dv">10</span>), ]</span>
<span id="cb38-13"><a href="#cb38-13"></a></span>
<span id="cb38-14"><a href="#cb38-14"></a>sampled_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    rownames pres.abs northing easting altitude distance NoOfPools NoOfSites
159      160        0      299    1021     1700     1750        82         6
207      208        0      295    1046     1580     1500         6         2
179      180        0      263    1012     1640     1000         4         2
14        15        1       91    1018     1510      250        16         5
195      196        0      273    1002     1760     1000        18         2
170      171        0      143    1045     1300     2750        17         1
50        51        1      194    1035     1480      250        10         3
118      119        0      227     986     1610     2500        10         3
43        44        1      217    1089     1490      500        80         4
209      210        0      299     730     1580     8000        16         0
      avrain  meanmin  meanmax
159 155.0000 2.433333 12.46667
207 143.3333 2.966667 13.50000
179 153.3333 2.733333 12.93333
14  159.0000 3.500000 13.86667
195 165.6667 2.233333 11.90000
170 132.3333 4.200000 15.80000
50  146.6667 3.533333 14.20000
118 155.3333 2.866667 13.10000
43  144.0000 3.566667 14.13333
209 138.0000 2.433333 13.40000</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>#Analysis of the data set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> meanmin, <span class="at">y =</span> meanmax, <span class="at">color =</span> altitude)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add linear regression line</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span>  <span class="co"># You can change the color scale if needed</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation between meanmin and meanmax with Altitude"</span>,</span>
<span id="cb40-6"><a href="#cb40-6"></a>       <span class="at">x =</span> <span class="st">"meanmin"</span>,</span>
<span id="cb40-7"><a href="#cb40-7"></a>       <span class="at">y =</span> <span class="st">"meanmax"</span>,</span>
<span id="cb40-8"><a href="#cb40-8"></a>       <span class="at">color =</span> <span class="st">"Altitude"</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Plot the absence of frogs as a function of meanmin and altitude</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> meanmin, <span class="at">y =</span> meanmax, <span class="at">color =</span> pres.abs, <span class="at">size =</span> pres.abs)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span>  <span class="co"># You can change the color scale if needed</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Absence of Frogs vs. meanmin and altitude"</span>,</span>
<span id="cb42-7"><a href="#cb42-7"></a>       <span class="at">x =</span> <span class="st">"meanmin"</span>,</span>
<span id="cb42-8"><a href="#cb42-8"></a>       <span class="at">y =</span> <span class="st">"meanmax"</span>,</span>
<span id="cb42-9"><a href="#cb42-9"></a>       <span class="at">size =</span> <span class="st">"Pres.Abs"</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> avrain)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add linear regression line</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span>  <span class="co"># You can change the color scale if needed</span></span>
<span id="cb43-5"><a href="#cb43-5"></a></span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Filter the data to include only the presence of frogs</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>presence_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>pres.abs <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb45-3"><a href="#cb45-3"></a></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co"># Plot the presence of frogs with respect to altitude and avrain</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> avrain)) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Presence of Frogs vs. Altitude and Avrain"</span>,</span>
<span id="cb45-8"><a href="#cb45-8"></a>       <span class="at">x =</span> <span class="st">"Altitude"</span>,</span>
<span id="cb45-9"><a href="#cb45-9"></a>       <span class="at">y =</span> <span class="st">"Avrain"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> NoOfPools)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Presence of Frogs vs. Altitude and NoOfPools"</span>,</span>
<span id="cb46-4"><a href="#cb46-4"></a>       <span class="at">x =</span> <span class="st">"Altitude"</span>,</span>
<span id="cb46-5"><a href="#cb46-5"></a>       <span class="at">y =</span> <span class="st">"NoOfPools"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> meanmin, <span class="at">y =</span> NoOfPools)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Presence of Frogs vs. MeanMin and NoOfPools"</span>,</span>
<span id="cb47-4"><a href="#cb47-4"></a>       <span class="at">x =</span> <span class="st">"MeanMin"</span>,</span>
<span id="cb47-5"><a href="#cb47-5"></a>       <span class="at">y =</span> <span class="st">"NoOfPools"</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data)</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="fu">print</span>(correlation_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            rownames    pres.abs    northing     easting   altitude   distance
rownames   1.0000000 -0.79379062  0.29039960 -0.23733975  0.2594501  0.3251945
pres.abs  -0.7937906  1.00000000 -0.39875706  0.32493331 -0.2384100 -0.3217480
northing   0.2903996 -0.39875706  1.00000000 -0.32390138  0.5098837  0.2416126
easting   -0.2373398  0.32493331 -0.32390138  1.00000000 -0.5147038 -0.5753061
altitude   0.2594501 -0.23841002  0.50988367 -0.51470383  1.0000000  0.1820645
distance   0.3251945 -0.32174803  0.24161260 -0.57530607  0.1820645  1.0000000
NoOfPools -0.1727391  0.17562416  0.07394787 -0.06503599  0.2667913 -0.0959017
NoOfSites -0.2665277  0.16070989  0.01818349  0.22410207 -0.1368677 -0.3656936
avrain     0.1257059 -0.01358179 -0.10914493 -0.39538028  0.7780271  0.1484831
meanmin   -0.3117578  0.34316473 -0.63320255  0.70890060 -0.9536610 -0.3263706
meanmax   -0.2505741  0.22265134 -0.45335004  0.53773711 -0.9965570 -0.2045681
            NoOfPools   NoOfSites      avrain    meanmin    meanmax
rownames  -0.17273915 -0.26652773  0.12570585 -0.3117578 -0.2505741
pres.abs   0.17562416  0.16070989 -0.01358179  0.3431647  0.2226513
northing   0.07394787  0.01818349 -0.10914493 -0.6332025 -0.4533500
easting   -0.06503599  0.22410207 -0.39538028  0.7089006  0.5377371
altitude   0.26679134 -0.13686765  0.77802713 -0.9536610 -0.9965570
distance  -0.09590170 -0.36569361  0.14848311 -0.3263706 -0.2045681
NoOfPools  1.00000000  0.07803560  0.24377919 -0.2237348 -0.2633172
NoOfSites  0.07803560  1.00000000 -0.21811450  0.1510355  0.1576344
avrain     0.24377919 -0.21811450  1.00000000 -0.6492240 -0.8186997
meanmin   -0.22373480  0.15103548 -0.64922402  1.0000000  0.9462741
meanmax   -0.26331723  0.15763440 -0.81869972  0.9462741  1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># Create a prettier plot of the correlation matrix</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">type =</span> <span class="st">"full"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Plot the correlations</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-3"><a href="#cb51-3"></a></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> avrain, <span class="at">color =</span> pres.abs)) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of pres.abs vs. Altitude and Avrain"</span>,</span>
<span id="cb51-7"><a href="#cb51-7"></a>       <span class="at">x =</span> <span class="st">"Altitude"</span>,</span>
<span id="cb51-8"><a href="#cb51-8"></a>       <span class="at">y =</span> <span class="st">"Avrain"</span>,</span>
<span id="cb51-9"><a href="#cb51-9"></a>       <span class="at">color =</span> <span class="st">"pres.abs"</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="forming-bayesian-regression-models-using-stan" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Forming bayesian regression models using Stan</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>priors1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"avrain"</span>),</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">15</span>,<span class="dv">10</span>), <span class="at">coef =</span> <span class="st">"meanmax"</span>),</span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1500</span>,<span class="dv">300</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb52-7"><a href="#cb52-7"></a>)</span>
<span id="cb52-8"><a href="#cb52-8"></a></span>
<span id="cb52-9"><a href="#cb52-9"></a></span>
<span id="cb52-10"><a href="#cb52-10"></a>fit1 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb52-11"><a href="#cb52-11"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb52-12"><a href="#cb52-12"></a>  pres.abs <span class="sc">~</span> altitude <span class="sc">+</span> avrain <span class="sc">+</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> meanmax,</span>
<span id="cb52-13"><a href="#cb52-13"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb52-14"><a href="#cb52-14"></a>  <span class="at">data =</span> data,</span>
<span id="cb52-15"><a href="#cb52-15"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb52-16"><a href="#cb52-16"></a>  <span class="at">family =</span> <span class="st">"bernoulli"</span>,</span>
<span id="cb52-17"><a href="#cb52-17"></a>  <span class="co"># This passes the priors specified above to brms</span></span>
<span id="cb52-18"><a href="#cb52-18"></a>  <span class="at">prior =</span> priors1,</span>
<span id="cb52-19"><a href="#cb52-19"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb52-20"><a href="#cb52-20"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit1"</span></span>
<span id="cb52-21"><a href="#cb52-21"></a>)</span>
<span id="cb52-22"><a href="#cb52-22"></a></span>
<span id="cb52-23"><a href="#cb52-23"></a>priors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-24"><a href="#cb52-24"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb52-25"><a href="#cb52-25"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb52-26"><a href="#cb52-26"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1500</span>,<span class="dv">300</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb52-27"><a href="#cb52-27"></a>)</span>
<span id="cb52-28"><a href="#cb52-28"></a></span>
<span id="cb52-29"><a href="#cb52-29"></a></span>
<span id="cb52-30"><a href="#cb52-30"></a>fit2 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb52-31"><a href="#cb52-31"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb52-32"><a href="#cb52-32"></a>  pres.abs <span class="sc">~</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> altitude,</span>
<span id="cb52-33"><a href="#cb52-33"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb52-34"><a href="#cb52-34"></a>  <span class="at">data =</span> data,</span>
<span id="cb52-35"><a href="#cb52-35"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb52-36"><a href="#cb52-36"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb52-37"><a href="#cb52-37"></a>  <span class="co"># This passes the priors specified above to brms</span></span>
<span id="cb52-38"><a href="#cb52-38"></a>  <span class="at">prior =</span> priors2,</span>
<span id="cb52-39"><a href="#cb52-39"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb52-40"><a href="#cb52-40"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit2"</span></span>
<span id="cb52-41"><a href="#cb52-41"></a>)</span>
<span id="cb52-42"><a href="#cb52-42"></a></span>
<span id="cb52-43"><a href="#cb52-43"></a>priors3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-44"><a href="#cb52-44"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb52-45"><a href="#cb52-45"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1500</span>,<span class="dv">300</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb52-46"><a href="#cb52-46"></a>)</span>
<span id="cb52-47"><a href="#cb52-47"></a></span>
<span id="cb52-48"><a href="#cb52-48"></a>fit3 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb52-49"><a href="#cb52-49"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb52-50"><a href="#cb52-50"></a>  pres.abs <span class="sc">~</span>  meanmin <span class="sc">+</span> altitude<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb52-51"><a href="#cb52-51"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb52-52"><a href="#cb52-52"></a>  <span class="at">data =</span> data,</span>
<span id="cb52-53"><a href="#cb52-53"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb52-54"><a href="#cb52-54"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb52-55"><a href="#cb52-55"></a>  <span class="co"># This passes the priors specified above to brms</span></span>
<span id="cb52-56"><a href="#cb52-56"></a>  <span class="at">prior =</span> priors3,</span>
<span id="cb52-57"><a href="#cb52-57"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb52-58"><a href="#cb52-58"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit3"</span></span>
<span id="cb52-59"><a href="#cb52-59"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="posterior-predictive-checking-and-model-analysis" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Posterior predictive checking and model analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>pp_check_fit1 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit1, <span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using all posterior draws for ppc type 'stat' by default.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>traceplot_fit1 <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit1, <span class="at">type =</span> <span class="st">"trace"</span>, <span class="at">prob=</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments were unrecognized and ignored: prob</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No divergences to plot.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>pp_check_fit2 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit2,<span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using all posterior draws for ppc type 'stat' by default.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>traceplot_fit2 <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit2, <span class="at">type =</span> <span class="st">"trace"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No divergences to plot.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>pp_check_fit3 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit3,<span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using all posterior draws for ppc type 'stat' by default.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>traceplot_fit3 <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit3, <span class="at">type =</span> <span class="st">"trace"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No divergences to plot.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit1)</span>
<span id="cb69-2"><a href="#cb69-2"></a>s2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit2)</span>
<span id="cb69-3"><a href="#cb69-3"></a>s3 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit3)</span>
<span id="cb69-4"><a href="#cb69-4"></a></span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="fu">print</span>(s1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: pres.abs ~ altitude + avrain + NoOfPools + meanmin + meanmax 
   Data: data (Number of observations: 212) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   -78.25    118.16  -317.67   143.88 1.00     1103     1168
altitude      0.03      0.03    -0.04     0.10 1.00     1135     1189
avrain        0.05      0.05    -0.06     0.16 1.00     1263     2004
NoOfPools     0.03      0.01     0.02     0.05 1.00     2634     2654
meanmin       6.14      1.36     3.52     8.92 1.00     2295     2448
meanmax       0.81      4.29    -7.26     9.41 1.00     1103     1328

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">print</span>(s2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: pres.abs ~ NoOfPools + meanmin + altitude 
   Data: data (Number of observations: 212) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   -60.90     11.79   -84.75   -39.50 1.00     1404     1870
NoOfPools     0.03      0.01     0.01     0.05 1.00     2383     2031
meanmin       6.72      1.16     4.55     9.08 1.00     1381     1881
altitude      0.02      0.01     0.01     0.04 1.00     1463     1894

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">print</span>(s3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: pres.abs ~ meanmin + altitude^2 
   Data: data (Number of observations: 212) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   -60.02     11.51   -82.70   -38.71 1.00     1171     1309
meanmin       6.38      1.12     4.30     8.61 1.00     1185     1419
altitude      0.03      0.01     0.02     0.04 1.00     1191     1371

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit1)</span>
<span id="cb75-2"><a href="#cb75-2"></a>r2 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit2)</span>
<span id="cb75-3"><a href="#cb75-3"></a>r3 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit3)</span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="fu">print</span>(r1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b_Intercept  b_altitude    b_avrain b_NoOfPools   b_meanmin   b_meanmax 
   1.001682    1.001412    1.002236    1.000579    1.001079    1.001654 
     lprior        lp__ 
   1.000519    1.002178 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">print</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b_Intercept b_NoOfPools   b_meanmin  b_altitude      lprior        lp__ 
   1.004646    1.000935    1.004281    1.004620    1.004556    1.001010 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">print</span>(r3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b_Intercept   b_meanmin  b_altitude      lprior        lp__ 
   1.002800    1.002660    1.002540    1.001230    1.000921 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">mcse</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Parameter         MCSE
1 b_Intercept 3.5691039928
2  b_altitude 0.0010223064
3    b_avrain 0.0015271118
4 b_NoOfPools 0.0001690033
5   b_meanmin 0.0285918130
6   b_meanmax 0.1295099968</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">mcse</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Parameter         MCSE
1 b_Intercept 0.3127218690
2 b_NoOfPools 0.0001736244
3   b_meanmin 0.0311892344
4  b_altitude 0.0001374450</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">mcse</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Parameter         MCSE
1 b_Intercept 0.3386960020
2   b_meanmin 0.0327356654
3  b_altitude 0.0001516418</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>loo_fit1 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit1)</span>
<span id="cb87-2"><a href="#cb87-2"></a>loo_fit2 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit2)</span>
<span id="cb87-3"><a href="#cb87-3"></a>loo_fit3 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit3)</span>
<span id="cb87-4"><a href="#cb87-4"></a></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="fu">loo_compare</span>(loo_fit1,loo_fit2,loo_fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     elpd_diff se_diff
fit2  0.0       0.0   
fit1 -1.3       1.4   
fit3 -6.5       3.9   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">print</span>(pp_check_fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">print</span>(pp_check_fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">print</span>(pp_check_fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#Prior Sensitivity analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>new_priors1_new <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb95-2"><a href="#cb95-2"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"avrain"</span>),</span>
<span id="cb95-3"><a href="#cb95-3"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb95-4"><a href="#cb95-4"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">20</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmax"</span>),</span>
<span id="cb95-5"><a href="#cb95-5"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb95-6"><a href="#cb95-6"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>,<span class="dv">1000</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb95-7"><a href="#cb95-7"></a>)</span>
<span id="cb95-8"><a href="#cb95-8"></a></span>
<span id="cb95-9"><a href="#cb95-9"></a></span>
<span id="cb95-10"><a href="#cb95-10"></a>fit_1_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb95-11"><a href="#cb95-11"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb95-12"><a href="#cb95-12"></a>  pres.abs <span class="sc">~</span> altitude <span class="sc">+</span> avrain <span class="sc">+</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> meanmax,</span>
<span id="cb95-13"><a href="#cb95-13"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb95-14"><a href="#cb95-14"></a>  <span class="at">data =</span> data,</span>
<span id="cb95-15"><a href="#cb95-15"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb95-16"><a href="#cb95-16"></a>  <span class="at">family =</span> <span class="st">"bernoulli"</span>,</span>
<span id="cb95-17"><a href="#cb95-17"></a>  <span class="co"># This passes the new_priors specified above to brms</span></span>
<span id="cb95-18"><a href="#cb95-18"></a>  <span class="at">prior =</span> new_priors1_new,</span>
<span id="cb95-19"><a href="#cb95-19"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb95-20"><a href="#cb95-20"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit_1_new_priors"</span></span>
<span id="cb95-21"><a href="#cb95-21"></a>)</span>
<span id="cb95-22"><a href="#cb95-22"></a></span>
<span id="cb95-23"><a href="#cb95-23"></a>new_priors2_new <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb95-24"><a href="#cb95-24"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb95-25"><a href="#cb95-25"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb95-26"><a href="#cb95-26"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>,<span class="dv">1000</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb95-27"><a href="#cb95-27"></a>)</span>
<span id="cb95-28"><a href="#cb95-28"></a></span>
<span id="cb95-29"><a href="#cb95-29"></a></span>
<span id="cb95-30"><a href="#cb95-30"></a>fit_2_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb95-31"><a href="#cb95-31"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb95-32"><a href="#cb95-32"></a>  pres.abs <span class="sc">~</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> altitude,</span>
<span id="cb95-33"><a href="#cb95-33"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb95-34"><a href="#cb95-34"></a>  <span class="at">data =</span> data,</span>
<span id="cb95-35"><a href="#cb95-35"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb95-36"><a href="#cb95-36"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb95-37"><a href="#cb95-37"></a>  <span class="co"># This passes the new_priors specified above to brms</span></span>
<span id="cb95-38"><a href="#cb95-38"></a>  <span class="at">prior =</span> new_priors2_new,</span>
<span id="cb95-39"><a href="#cb95-39"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb95-40"><a href="#cb95-40"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit_2_new_priors_new_prior"</span></span>
<span id="cb95-41"><a href="#cb95-41"></a>)</span>
<span id="cb95-42"><a href="#cb95-42"></a></span>
<span id="cb95-43"><a href="#cb95-43"></a>new_priors3_new <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb95-44"><a href="#cb95-44"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb95-45"><a href="#cb95-45"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>,<span class="dv">1000</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb95-46"><a href="#cb95-46"></a>)</span>
<span id="cb95-47"><a href="#cb95-47"></a></span>
<span id="cb95-48"><a href="#cb95-48"></a>fit_3_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb95-49"><a href="#cb95-49"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb95-50"><a href="#cb95-50"></a>  pres.abs <span class="sc">~</span>  meanmin <span class="sc">+</span> altitude<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb95-51"><a href="#cb95-51"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb95-52"><a href="#cb95-52"></a>  <span class="at">data =</span> data,</span>
<span id="cb95-53"><a href="#cb95-53"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb95-54"><a href="#cb95-54"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb95-55"><a href="#cb95-55"></a>  <span class="co"># This passes the new_priors specified above to brms</span></span>
<span id="cb95-56"><a href="#cb95-56"></a>  <span class="at">prior =</span> new_priors3_new,</span>
<span id="cb95-57"><a href="#cb95-57"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb95-58"><a href="#cb95-58"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit_3_new_priors"</span></span>
<span id="cb95-59"><a href="#cb95-59"></a>)</span>
<span id="cb95-60"><a href="#cb95-60"></a></span>
<span id="cb95-61"><a href="#cb95-61"></a>pp_check_fit_1_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit_1_new_priors, <span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using all posterior draws for ppc type 'stat' by default.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>traceplot_fit_1_new_priors <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit_1_new_priors, <span class="at">type =</span> <span class="st">"trace"</span>, <span class="at">prob=</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments were unrecognized and ignored: prob</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No divergences to plot.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>pp_check_fit_2_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit_2_new_priors, <span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using all posterior draws for ppc type 'stat' by default.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>traceplot_fit_2_new_priors <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit_2_new_priors, <span class="at">type =</span> <span class="st">"trace"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No divergences to plot.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>pp_check_fit_3_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit_3_new_priors, <span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using all posterior draws for ppc type 'stat' by default.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>traceplot_fit_3_new_priors <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit_3_new_priors, <span class="at">type =</span> <span class="st">"trace"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Method 'stanplot' is deprecated. Please use 'mcmc_plot' instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No divergences to plot.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>s1_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_1_new_priors)</span>
<span id="cb111-2"><a href="#cb111-2"></a>s2_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_2_new_priors)</span>
<span id="cb111-3"><a href="#cb111-3"></a>s3_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_3_new_priors)</span>
<span id="cb111-4"><a href="#cb111-4"></a></span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="fu">print</span>(s1_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: pres.abs ~ altitude + avrain + NoOfPools + meanmin + meanmax 
   Data: data (Number of observations: 212) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   -26.07    124.76  -264.68   220.92 1.01     1278     2048
altitude      0.01      0.04    -0.06     0.08 1.01     1314     2058
avrain        0.02      0.06    -0.09     0.13 1.01     1417     1994
NoOfPools     0.03      0.01     0.02     0.05 1.00     2312     2480
meanmin       6.66      1.49     3.87     9.67 1.00     2271     2420
meanmax      -1.28      4.58   -10.39     7.36 1.01     1282     1923

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">print</span>(s2_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: pres.abs ~ NoOfPools + meanmin + altitude 
   Data: data (Number of observations: 212) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   -66.66     13.73   -93.98   -40.28 1.00     1630     2012
NoOfPools     0.03      0.01     0.01     0.05 1.00     2124     1691
meanmin       7.29      1.36     4.68    10.00 1.00     1631     1983
altitude      0.03      0.01     0.02     0.04 1.00     1660     2005

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">print</span>(s3_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: pres.abs ~ meanmin + altitude^2 
   Data: data (Number of observations: 212) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   -63.24     13.20   -90.41   -39.12 1.01     1215     1407
meanmin       6.70      1.29     4.34     9.34 1.01     1202     1416
altitude      0.03      0.01     0.02     0.04 1.01     1228     1472

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit_1_new_priors)</span>
<span id="cb117-2"><a href="#cb117-2"></a>r2_new <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit_2_new_priors)</span>
<span id="cb117-3"><a href="#cb117-3"></a>r3_new <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit_3_new_priors)</span>
<span id="cb117-4"><a href="#cb117-4"></a><span class="fu">print</span>(r1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b_Intercept  b_altitude    b_avrain b_NoOfPools   b_meanmin   b_meanmax 
   1.006017    1.005760    1.005071    1.001669    1.003104    1.006261 
     lprior        lp__ 
   1.005584    1.000081 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="fu">print</span>(r2_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b_Intercept b_NoOfPools   b_meanmin  b_altitude      lprior        lp__ 
   1.001738    1.001123    1.001881    1.001626    1.002028    1.000560 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="fu">print</span>(r3_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>b_Intercept   b_meanmin  b_altitude      lprior        lp__ 
   1.005434    1.005309    1.005380    1.004929    1.002796 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>loo_fit_1_new_priors <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_1_new_priors)</span>
<span id="cb123-2"><a href="#cb123-2"></a>loo_fit_2_new_priors <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_2_new_priors)</span>
<span id="cb123-3"><a href="#cb123-3"></a>loo_fit_3_new_priors <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_3_new_priors)</span>
<span id="cb123-4"><a href="#cb123-4"></a></span>
<span id="cb123-5"><a href="#cb123-5"></a><span class="fu">loo_compare</span>(loo_fit_1_new_priors,loo_fit_2_new_priors,loo_fit_3_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 elpd_diff se_diff
fit_2_new_priors  0.0       0.0   
fit_1_new_priors -1.0       1.3   
fit_3_new_priors -6.5       3.9   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="fu">print</span>(pp_check_fit_1_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="fu">print</span>(pp_check_fit_2_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="fu">print</span>(pp_check_fit_3_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="fu">print</span>(traceplot_fit_1_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="fu">print</span>(traceplot_fit_2_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="fu">print</span>(traceplot_fit_3_new_priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="BDAproject_files/figure-html/unnamed-chunk-17-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="fu">stancode</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>// generated with brms 2.20.4
functions {
  
}
data {
  int&lt;lower=1&gt; N; // total number of observations
  array[N] int Y; // response variable
  int&lt;lower=1&gt; K; // number of population-level effects
  matrix[N, K] X; // population-level design matrix
  int&lt;lower=1&gt; Kc; // number of population-level effects after centering
  int prior_only; // should the likelihood be ignored?
}
transformed data {
  matrix[N, Kc] Xc; // centered version of X without an intercept
  vector[Kc] means_X; // column means of X before centering
  for (i in 2 : K) {
    means_X[i - 1] = mean(X[ : , i]);
    Xc[ : , i - 1] = X[ : , i] - means_X[i - 1];
  }
}
parameters {
  vector[Kc] b; // regression coefficients
  real Intercept; // temporary intercept for centered predictors
}
transformed parameters {
  real lprior = 0; // prior contributions to the log posterior
  lprior += normal_lpdf(b[1] | 1500, 300);
  lprior += normal_lpdf(b[2] | 0, 100);
  lprior += normal_lpdf(b[3] | 0, 100);
  lprior += normal_lpdf(b[4] | 4, 3);
  lprior += normal_lpdf(b[5] | 15, 10);
  lprior += student_t_lpdf(Intercept | 3, 0, 2.5);
}
model {
  // likelihood including constants
  if (!prior_only) {
    target += bernoulli_logit_glm_lpmf(Y | Xc, Intercept, b);
  }
  // priors including constants
  target += lprior;
}
generated quantities {
  // actual population-level intercept
  real b_Intercept = Intercept - dot_product(means_X, b);
}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="fu">stancode</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>// generated with brms 2.20.4
functions {
  
}
data {
  int&lt;lower=1&gt; N; // total number of observations
  array[N] int Y; // response variable
  int&lt;lower=1&gt; K; // number of population-level effects
  matrix[N, K] X; // population-level design matrix
  int&lt;lower=1&gt; Kc; // number of population-level effects after centering
  int prior_only; // should the likelihood be ignored?
}
transformed data {
  matrix[N, Kc] Xc; // centered version of X without an intercept
  vector[Kc] means_X; // column means of X before centering
  for (i in 2 : K) {
    means_X[i - 1] = mean(X[ : , i]);
    Xc[ : , i - 1] = X[ : , i] - means_X[i - 1];
  }
}
parameters {
  vector[Kc] b; // regression coefficients
  real Intercept; // temporary intercept for centered predictors
}
transformed parameters {
  real lprior = 0; // prior contributions to the log posterior
  lprior += normal_lpdf(b[1] | 0, 100);
  lprior += normal_lpdf(b[2] | 4, 3);
  lprior += normal_lpdf(b[3] | 1500, 300);
  lprior += student_t_lpdf(Intercept | 3, 0, 2.5);
}
model {
  // likelihood including constants
  if (!prior_only) {
    target += bernoulli_logit_glm_lpmf(Y | Xc, Intercept, b);
  }
  // priors including constants
  target += lprior;
}
generated quantities {
  // actual population-level intercept
  real b_Intercept = Intercept - dot_product(means_X, b);
}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="fu">stancode</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>// generated with brms 2.20.4
functions {
  
}
data {
  int&lt;lower=1&gt; N; // total number of observations
  array[N] int Y; // response variable
  int&lt;lower=1&gt; K; // number of population-level effects
  matrix[N, K] X; // population-level design matrix
  int&lt;lower=1&gt; Kc; // number of population-level effects after centering
  int prior_only; // should the likelihood be ignored?
}
transformed data {
  matrix[N, Kc] Xc; // centered version of X without an intercept
  vector[Kc] means_X; // column means of X before centering
  for (i in 2 : K) {
    means_X[i - 1] = mean(X[ : , i]);
    Xc[ : , i - 1] = X[ : , i] - means_X[i - 1];
  }
}
parameters {
  vector[Kc] b; // regression coefficients
  real Intercept; // temporary intercept for centered predictors
}
transformed parameters {
  real lprior = 0; // prior contributions to the log posterior
  lprior += normal_lpdf(b[1] | 4, 3);
  lprior += normal_lpdf(b[2] | 1500, 300);
  lprior += student_t_lpdf(Intercept | 3, 0, 2.5);
}
model {
  // likelihood including constants
  if (!prior_only) {
    target += bernoulli_logit_glm_lpmf(Y | Xc, Intercept, b);
  }
  // priors including constants
  target += lprior;
}
generated quantities {
  // actual population-level intercept
  real b_Intercept = Intercept - dot_product(means_X, b);
}</code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb140" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb140-1"><a href="#cb140-1"></a><span class="co">---</span></span>
<span id="cb140-2"><a href="#cb140-2"></a><span class="an">format:</span></span>
<span id="cb140-3"><a href="#cb140-3"></a><span class="co">  html:</span></span>
<span id="cb140-4"><a href="#cb140-4"></a><span class="co">    toc: true</span></span>
<span id="cb140-5"><a href="#cb140-5"></a><span class="co">    code-tools: true</span></span>
<span id="cb140-6"><a href="#cb140-6"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb140-7"><a href="#cb140-7"></a><span class="co">    number-sections: true</span></span>
<span id="cb140-8"><a href="#cb140-8"></a><span class="co">    mainfont: Georgia, serif</span></span>
<span id="cb140-9"><a href="#cb140-9"></a><span class="co">    page-layout: article</span></span>
<span id="cb140-10"><a href="#cb140-10"></a><span class="co">  pdf:  </span></span>
<span id="cb140-11"><a href="#cb140-11"></a><span class="co">    geometry:</span></span>
<span id="cb140-12"><a href="#cb140-12"></a><span class="co">    - left=3cm,top=2cm,bottom=2cm,right=3cm</span></span>
<span id="cb140-13"><a href="#cb140-13"></a><span class="co">    number-sections: true</span></span>
<span id="cb140-14"><a href="#cb140-14"></a><span class="co">    code-annotations: none</span></span>
<span id="cb140-15"><a href="#cb140-15"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb140-16"><a href="#cb140-16"></a><span class="co">---</span></span>
<span id="cb140-17"><a href="#cb140-17"></a></span>
<span id="cb140-18"><a href="#cb140-18"></a></span>
<span id="cb140-19"><a href="#cb140-19"></a></span>
<span id="cb140-20"><a href="#cb140-20"></a>:::: {.content-hidden when-format="pdf"}</span>
<span id="cb140-21"><a href="#cb140-21"></a>::: {.callout-warning collapse=false}</span>
<span id="cb140-24"><a href="#cb140-24"></a><span class="in">```{r}</span></span>
<span id="cb140-25"><a href="#cb140-25"></a><span class="co">#| label: imports</span></span>
<span id="cb140-26"><a href="#cb140-26"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb140-27"><a href="#cb140-27"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb140-28"><a href="#cb140-28"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb140-29"><a href="#cb140-29"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb140-30"><a href="#cb140-30"></a><span class="fu">library</span>(ggdist) <span class="co"># for stat_dotsinterval</span></span>
<span id="cb140-31"><a href="#cb140-31"></a><span class="fu">library</span>(posterior)</span>
<span id="cb140-32"><a href="#cb140-32"></a><span class="fu">library</span>(brms)</span>
<span id="cb140-33"><a href="#cb140-33"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb140-34"><a href="#cb140-34"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb140-35"><a href="#cb140-35"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb140-36"><a href="#cb140-36"></a><span class="co"># Globally specfiy cmdstan backend for brms</span></span>
<span id="cb140-37"><a href="#cb140-37"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>)</span>
<span id="cb140-38"><a href="#cb140-38"></a><span class="co"># Tell brms to cache results if possible</span></span>
<span id="cb140-39"><a href="#cb140-39"></a><span class="fu">options</span>(<span class="at">brms.file_refit=</span><span class="st">"on_change"</span>)</span>
<span id="cb140-40"><a href="#cb140-40"></a></span>
<span id="cb140-41"><a href="#cb140-41"></a><span class="co"># Set more readable themes with bigger font for plotting packages</span></span>
<span id="cb140-42"><a href="#cb140-42"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb140-43"><a href="#cb140-43"></a>bayesplot<span class="sc">::</span><span class="fu">bayesplot_theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb140-44"><a href="#cb140-44"></a></span>
<span id="cb140-45"><a href="#cb140-45"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb140-46"><a href="#cb140-46"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"frogs.csv"</span>)</span>
<span id="cb140-47"><a href="#cb140-47"></a>sampled_data <span class="ot">&lt;-</span> data[<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="dv">10</span>), ]</span>
<span id="cb140-48"><a href="#cb140-48"></a></span>
<span id="cb140-49"><a href="#cb140-49"></a>sampled_data</span>
<span id="cb140-50"><a href="#cb140-50"></a><span class="in">```</span></span>
<span id="cb140-51"><a href="#cb140-51"></a>:::</span>
<span id="cb140-52"><a href="#cb140-52"></a>::::</span>
<span id="cb140-53"><a href="#cb140-53"></a>#Analysis of the data set</span>
<span id="cb140-54"><a href="#cb140-54"></a></span>
<span id="cb140-57"><a href="#cb140-57"></a><span class="in">```{r}</span></span>
<span id="cb140-58"><a href="#cb140-58"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> meanmin, <span class="at">y =</span> meanmax, <span class="at">color =</span> altitude)) <span class="sc">+</span></span>
<span id="cb140-59"><a href="#cb140-59"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb140-60"><a href="#cb140-60"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add linear regression line</span></span>
<span id="cb140-61"><a href="#cb140-61"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span>  <span class="co"># You can change the color scale if needed</span></span>
<span id="cb140-62"><a href="#cb140-62"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation between meanmin and meanmax with Altitude"</span>,</span>
<span id="cb140-63"><a href="#cb140-63"></a>       <span class="at">x =</span> <span class="st">"meanmin"</span>,</span>
<span id="cb140-64"><a href="#cb140-64"></a>       <span class="at">y =</span> <span class="st">"meanmax"</span>,</span>
<span id="cb140-65"><a href="#cb140-65"></a>       <span class="at">color =</span> <span class="st">"Altitude"</span>) <span class="sc">+</span></span>
<span id="cb140-66"><a href="#cb140-66"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-67"><a href="#cb140-67"></a></span>
<span id="cb140-68"><a href="#cb140-68"></a><span class="in">```</span></span>
<span id="cb140-69"><a href="#cb140-69"></a></span>
<span id="cb140-72"><a href="#cb140-72"></a><span class="in">```{r}</span></span>
<span id="cb140-73"><a href="#cb140-73"></a><span class="co"># Plot the absence of frogs as a function of meanmin and altitude</span></span>
<span id="cb140-74"><a href="#cb140-74"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> meanmin, <span class="at">y =</span> meanmax, <span class="at">color =</span> pres.abs, <span class="at">size =</span> pres.abs)) <span class="sc">+</span></span>
<span id="cb140-75"><a href="#cb140-75"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb140-76"><a href="#cb140-76"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span>  <span class="co"># You can change the color scale if needed</span></span>
<span id="cb140-77"><a href="#cb140-77"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb140-78"><a href="#cb140-78"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Absence of Frogs vs. meanmin and altitude"</span>,</span>
<span id="cb140-79"><a href="#cb140-79"></a>       <span class="at">x =</span> <span class="st">"meanmin"</span>,</span>
<span id="cb140-80"><a href="#cb140-80"></a>       <span class="at">y =</span> <span class="st">"meanmax"</span>,</span>
<span id="cb140-81"><a href="#cb140-81"></a>       <span class="at">size =</span> <span class="st">"Pres.Abs"</span>) <span class="sc">+</span></span>
<span id="cb140-82"><a href="#cb140-82"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-83"><a href="#cb140-83"></a><span class="in">```</span></span>
<span id="cb140-84"><a href="#cb140-84"></a></span>
<span id="cb140-87"><a href="#cb140-87"></a><span class="in">```{r}</span></span>
<span id="cb140-88"><a href="#cb140-88"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> avrain)) <span class="sc">+</span></span>
<span id="cb140-89"><a href="#cb140-89"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb140-90"><a href="#cb140-90"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add linear regression line</span></span>
<span id="cb140-91"><a href="#cb140-91"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span>  <span class="co"># You can change the color scale if needed</span></span>
<span id="cb140-92"><a href="#cb140-92"></a></span>
<span id="cb140-93"><a href="#cb140-93"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-94"><a href="#cb140-94"></a></span>
<span id="cb140-95"><a href="#cb140-95"></a><span class="in">```</span></span>
<span id="cb140-96"><a href="#cb140-96"></a></span>
<span id="cb140-99"><a href="#cb140-99"></a><span class="in">```{r}</span></span>
<span id="cb140-100"><a href="#cb140-100"></a><span class="co"># Filter the data to include only the presence of frogs</span></span>
<span id="cb140-101"><a href="#cb140-101"></a>presence_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>pres.abs <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb140-102"><a href="#cb140-102"></a></span>
<span id="cb140-103"><a href="#cb140-103"></a><span class="co"># Plot the presence of frogs with respect to altitude and avrain</span></span>
<span id="cb140-104"><a href="#cb140-104"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> avrain)) <span class="sc">+</span></span>
<span id="cb140-105"><a href="#cb140-105"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb140-106"><a href="#cb140-106"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Presence of Frogs vs. Altitude and Avrain"</span>,</span>
<span id="cb140-107"><a href="#cb140-107"></a>       <span class="at">x =</span> <span class="st">"Altitude"</span>,</span>
<span id="cb140-108"><a href="#cb140-108"></a>       <span class="at">y =</span> <span class="st">"Avrain"</span>) <span class="sc">+</span></span>
<span id="cb140-109"><a href="#cb140-109"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-110"><a href="#cb140-110"></a></span>
<span id="cb140-111"><a href="#cb140-111"></a><span class="in">```</span></span>
<span id="cb140-112"><a href="#cb140-112"></a></span>
<span id="cb140-115"><a href="#cb140-115"></a><span class="in">```{r}</span></span>
<span id="cb140-116"><a href="#cb140-116"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> NoOfPools)) <span class="sc">+</span></span>
<span id="cb140-117"><a href="#cb140-117"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb140-118"><a href="#cb140-118"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Presence of Frogs vs. Altitude and NoOfPools"</span>,</span>
<span id="cb140-119"><a href="#cb140-119"></a>       <span class="at">x =</span> <span class="st">"Altitude"</span>,</span>
<span id="cb140-120"><a href="#cb140-120"></a>       <span class="at">y =</span> <span class="st">"NoOfPools"</span>) <span class="sc">+</span></span>
<span id="cb140-121"><a href="#cb140-121"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-122"><a href="#cb140-122"></a><span class="in">```</span></span>
<span id="cb140-123"><a href="#cb140-123"></a></span>
<span id="cb140-126"><a href="#cb140-126"></a><span class="in">```{r}</span></span>
<span id="cb140-127"><a href="#cb140-127"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> meanmin, <span class="at">y =</span> NoOfPools)) <span class="sc">+</span></span>
<span id="cb140-128"><a href="#cb140-128"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb140-129"><a href="#cb140-129"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Presence of Frogs vs. MeanMin and NoOfPools"</span>,</span>
<span id="cb140-130"><a href="#cb140-130"></a>       <span class="at">x =</span> <span class="st">"MeanMin"</span>,</span>
<span id="cb140-131"><a href="#cb140-131"></a>       <span class="at">y =</span> <span class="st">"NoOfPools"</span>) <span class="sc">+</span></span>
<span id="cb140-132"><a href="#cb140-132"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-133"><a href="#cb140-133"></a><span class="in">```</span></span>
<span id="cb140-134"><a href="#cb140-134"></a></span>
<span id="cb140-137"><a href="#cb140-137"></a><span class="in">```{r}</span></span>
<span id="cb140-138"><a href="#cb140-138"></a><span class="co"># Calculate correlations</span></span>
<span id="cb140-139"><a href="#cb140-139"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data)</span>
<span id="cb140-140"><a href="#cb140-140"></a><span class="fu">print</span>(correlation_matrix)</span>
<span id="cb140-141"><a href="#cb140-141"></a><span class="co"># Create a prettier plot of the correlation matrix</span></span>
<span id="cb140-142"><a href="#cb140-142"></a><span class="fu">corrplot</span>(correlation_matrix, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">type =</span> <span class="st">"full"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb140-143"><a href="#cb140-143"></a></span>
<span id="cb140-144"><a href="#cb140-144"></a><span class="co"># Plot the correlations</span></span>
<span id="cb140-145"><a href="#cb140-145"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb140-146"><a href="#cb140-146"></a></span>
<span id="cb140-147"><a href="#cb140-147"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> altitude, <span class="at">y =</span> avrain, <span class="at">color =</span> pres.abs)) <span class="sc">+</span></span>
<span id="cb140-148"><a href="#cb140-148"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb140-149"><a href="#cb140-149"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter Plot of pres.abs vs. Altitude and Avrain"</span>,</span>
<span id="cb140-150"><a href="#cb140-150"></a>       <span class="at">x =</span> <span class="st">"Altitude"</span>,</span>
<span id="cb140-151"><a href="#cb140-151"></a>       <span class="at">y =</span> <span class="st">"Avrain"</span>,</span>
<span id="cb140-152"><a href="#cb140-152"></a>       <span class="at">color =</span> <span class="st">"pres.abs"</span>) <span class="sc">+</span></span>
<span id="cb140-153"><a href="#cb140-153"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb140-154"><a href="#cb140-154"></a></span>
<span id="cb140-155"><a href="#cb140-155"></a><span class="in">```</span></span>
<span id="cb140-156"><a href="#cb140-156"></a></span>
<span id="cb140-157"><a href="#cb140-157"></a></span>
<span id="cb140-158"><a href="#cb140-158"></a><span class="fu"># Forming bayesian regression models using Stan</span></span>
<span id="cb140-159"><a href="#cb140-159"></a></span>
<span id="cb140-162"><a href="#cb140-162"></a><span class="in">```{r}</span></span>
<span id="cb140-163"><a href="#cb140-163"></a>priors1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb140-164"><a href="#cb140-164"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"avrain"</span>),</span>
<span id="cb140-165"><a href="#cb140-165"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb140-166"><a href="#cb140-166"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">15</span>,<span class="dv">10</span>), <span class="at">coef =</span> <span class="st">"meanmax"</span>),</span>
<span id="cb140-167"><a href="#cb140-167"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb140-168"><a href="#cb140-168"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1500</span>,<span class="dv">300</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb140-169"><a href="#cb140-169"></a>)</span>
<span id="cb140-170"><a href="#cb140-170"></a></span>
<span id="cb140-171"><a href="#cb140-171"></a></span>
<span id="cb140-172"><a href="#cb140-172"></a>fit1 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb140-173"><a href="#cb140-173"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb140-174"><a href="#cb140-174"></a>  pres.abs <span class="sc">~</span> altitude <span class="sc">+</span> avrain <span class="sc">+</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> meanmax,</span>
<span id="cb140-175"><a href="#cb140-175"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb140-176"><a href="#cb140-176"></a>  <span class="at">data =</span> data,</span>
<span id="cb140-177"><a href="#cb140-177"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb140-178"><a href="#cb140-178"></a>  <span class="at">family =</span> <span class="st">"bernoulli"</span>,</span>
<span id="cb140-179"><a href="#cb140-179"></a>  <span class="co"># This passes the priors specified above to brms</span></span>
<span id="cb140-180"><a href="#cb140-180"></a>  <span class="at">prior =</span> priors1,</span>
<span id="cb140-181"><a href="#cb140-181"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb140-182"><a href="#cb140-182"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit1"</span></span>
<span id="cb140-183"><a href="#cb140-183"></a>)</span>
<span id="cb140-184"><a href="#cb140-184"></a></span>
<span id="cb140-185"><a href="#cb140-185"></a>priors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb140-186"><a href="#cb140-186"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb140-187"><a href="#cb140-187"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb140-188"><a href="#cb140-188"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1500</span>,<span class="dv">300</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb140-189"><a href="#cb140-189"></a>)</span>
<span id="cb140-190"><a href="#cb140-190"></a></span>
<span id="cb140-191"><a href="#cb140-191"></a></span>
<span id="cb140-192"><a href="#cb140-192"></a>fit2 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb140-193"><a href="#cb140-193"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb140-194"><a href="#cb140-194"></a>  pres.abs <span class="sc">~</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> altitude,</span>
<span id="cb140-195"><a href="#cb140-195"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb140-196"><a href="#cb140-196"></a>  <span class="at">data =</span> data,</span>
<span id="cb140-197"><a href="#cb140-197"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb140-198"><a href="#cb140-198"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb140-199"><a href="#cb140-199"></a>  <span class="co"># This passes the priors specified above to brms</span></span>
<span id="cb140-200"><a href="#cb140-200"></a>  <span class="at">prior =</span> priors2,</span>
<span id="cb140-201"><a href="#cb140-201"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb140-202"><a href="#cb140-202"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit2"</span></span>
<span id="cb140-203"><a href="#cb140-203"></a>)</span>
<span id="cb140-204"><a href="#cb140-204"></a></span>
<span id="cb140-205"><a href="#cb140-205"></a>priors3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb140-206"><a href="#cb140-206"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb140-207"><a href="#cb140-207"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1500</span>,<span class="dv">300</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb140-208"><a href="#cb140-208"></a>)</span>
<span id="cb140-209"><a href="#cb140-209"></a></span>
<span id="cb140-210"><a href="#cb140-210"></a>fit3 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb140-211"><a href="#cb140-211"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb140-212"><a href="#cb140-212"></a>  pres.abs <span class="sc">~</span>  meanmin <span class="sc">+</span> altitude<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb140-213"><a href="#cb140-213"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb140-214"><a href="#cb140-214"></a>  <span class="at">data =</span> data,</span>
<span id="cb140-215"><a href="#cb140-215"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb140-216"><a href="#cb140-216"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb140-217"><a href="#cb140-217"></a>  <span class="co"># This passes the priors specified above to brms</span></span>
<span id="cb140-218"><a href="#cb140-218"></a>  <span class="at">prior =</span> priors3,</span>
<span id="cb140-219"><a href="#cb140-219"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb140-220"><a href="#cb140-220"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit3"</span></span>
<span id="cb140-221"><a href="#cb140-221"></a>)</span>
<span id="cb140-222"><a href="#cb140-222"></a><span class="in">```</span></span>
<span id="cb140-223"><a href="#cb140-223"></a></span>
<span id="cb140-224"><a href="#cb140-224"></a></span>
<span id="cb140-225"><a href="#cb140-225"></a></span>
<span id="cb140-226"><a href="#cb140-226"></a><span class="fu"># Posterior predictive checking and model analysis</span></span>
<span id="cb140-229"><a href="#cb140-229"></a><span class="in">```{r}</span></span>
<span id="cb140-230"><a href="#cb140-230"></a>pp_check_fit1 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit1, <span class="st">"stat"</span>)</span>
<span id="cb140-231"><a href="#cb140-231"></a>traceplot_fit1 <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit1, <span class="at">type =</span> <span class="st">"trace"</span>, <span class="at">prob=</span> <span class="fl">0.95</span>)</span>
<span id="cb140-232"><a href="#cb140-232"></a></span>
<span id="cb140-233"><a href="#cb140-233"></a>pp_check_fit2 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit2,<span class="st">"stat"</span>)</span>
<span id="cb140-234"><a href="#cb140-234"></a>traceplot_fit2 <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit2, <span class="at">type =</span> <span class="st">"trace"</span>)</span>
<span id="cb140-235"><a href="#cb140-235"></a></span>
<span id="cb140-236"><a href="#cb140-236"></a>pp_check_fit3 <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit3,<span class="st">"stat"</span>)</span>
<span id="cb140-237"><a href="#cb140-237"></a>traceplot_fit3 <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit3, <span class="at">type =</span> <span class="st">"trace"</span>)</span>
<span id="cb140-238"><a href="#cb140-238"></a><span class="in">```</span></span>
<span id="cb140-241"><a href="#cb140-241"></a><span class="in">```{r}</span></span>
<span id="cb140-242"><a href="#cb140-242"></a>s1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit1)</span>
<span id="cb140-243"><a href="#cb140-243"></a>s2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit2)</span>
<span id="cb140-244"><a href="#cb140-244"></a>s3 <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit3)</span>
<span id="cb140-245"><a href="#cb140-245"></a></span>
<span id="cb140-246"><a href="#cb140-246"></a><span class="fu">print</span>(s1)</span>
<span id="cb140-247"><a href="#cb140-247"></a><span class="fu">print</span>(s2)</span>
<span id="cb140-248"><a href="#cb140-248"></a><span class="fu">print</span>(s3)</span>
<span id="cb140-249"><a href="#cb140-249"></a></span>
<span id="cb140-250"><a href="#cb140-250"></a></span>
<span id="cb140-251"><a href="#cb140-251"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit1)</span>
<span id="cb140-252"><a href="#cb140-252"></a>r2 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit2)</span>
<span id="cb140-253"><a href="#cb140-253"></a>r3 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit3)</span>
<span id="cb140-254"><a href="#cb140-254"></a><span class="fu">print</span>(r1)</span>
<span id="cb140-255"><a href="#cb140-255"></a><span class="fu">print</span>(r2)</span>
<span id="cb140-256"><a href="#cb140-256"></a><span class="fu">print</span>(r3)</span>
<span id="cb140-257"><a href="#cb140-257"></a></span>
<span id="cb140-258"><a href="#cb140-258"></a><span class="fu">mcse</span>(fit1)</span>
<span id="cb140-259"><a href="#cb140-259"></a><span class="fu">mcse</span>(fit2)</span>
<span id="cb140-260"><a href="#cb140-260"></a><span class="fu">mcse</span>(fit3)</span>
<span id="cb140-261"><a href="#cb140-261"></a><span class="in">```</span></span>
<span id="cb140-262"><a href="#cb140-262"></a></span>
<span id="cb140-263"><a href="#cb140-263"></a></span>
<span id="cb140-264"><a href="#cb140-264"></a></span>
<span id="cb140-265"><a href="#cb140-265"></a></span>
<span id="cb140-268"><a href="#cb140-268"></a><span class="in">```{r}</span></span>
<span id="cb140-269"><a href="#cb140-269"></a>loo_fit1 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit1)</span>
<span id="cb140-270"><a href="#cb140-270"></a>loo_fit2 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit2)</span>
<span id="cb140-271"><a href="#cb140-271"></a>loo_fit3 <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit3)</span>
<span id="cb140-272"><a href="#cb140-272"></a></span>
<span id="cb140-273"><a href="#cb140-273"></a><span class="fu">loo_compare</span>(loo_fit1,loo_fit2,loo_fit3)</span>
<span id="cb140-274"><a href="#cb140-274"></a><span class="in">```</span></span>
<span id="cb140-275"><a href="#cb140-275"></a></span>
<span id="cb140-276"><a href="#cb140-276"></a></span>
<span id="cb140-277"><a href="#cb140-277"></a></span>
<span id="cb140-278"><a href="#cb140-278"></a></span>
<span id="cb140-281"><a href="#cb140-281"></a><span class="in">```{r}</span></span>
<span id="cb140-282"><a href="#cb140-282"></a><span class="fu">print</span>(pp_check_fit1)</span>
<span id="cb140-283"><a href="#cb140-283"></a><span class="fu">print</span>(pp_check_fit2)</span>
<span id="cb140-284"><a href="#cb140-284"></a><span class="fu">print</span>(pp_check_fit3)</span>
<span id="cb140-285"><a href="#cb140-285"></a></span>
<span id="cb140-286"><a href="#cb140-286"></a><span class="in">```</span></span>
<span id="cb140-287"><a href="#cb140-287"></a></span>
<span id="cb140-288"><a href="#cb140-288"></a>#Prior Sensitivity analysis</span>
<span id="cb140-291"><a href="#cb140-291"></a><span class="in">```{r}</span></span>
<span id="cb140-292"><a href="#cb140-292"></a>new_priors1_new <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb140-293"><a href="#cb140-293"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"avrain"</span>),</span>
<span id="cb140-294"><a href="#cb140-294"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb140-295"><a href="#cb140-295"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">20</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmax"</span>),</span>
<span id="cb140-296"><a href="#cb140-296"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb140-297"><a href="#cb140-297"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>,<span class="dv">1000</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb140-298"><a href="#cb140-298"></a>)</span>
<span id="cb140-299"><a href="#cb140-299"></a></span>
<span id="cb140-300"><a href="#cb140-300"></a></span>
<span id="cb140-301"><a href="#cb140-301"></a>fit_1_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb140-302"><a href="#cb140-302"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb140-303"><a href="#cb140-303"></a>  pres.abs <span class="sc">~</span> altitude <span class="sc">+</span> avrain <span class="sc">+</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> meanmax,</span>
<span id="cb140-304"><a href="#cb140-304"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb140-305"><a href="#cb140-305"></a>  <span class="at">data =</span> data,</span>
<span id="cb140-306"><a href="#cb140-306"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb140-307"><a href="#cb140-307"></a>  <span class="at">family =</span> <span class="st">"bernoulli"</span>,</span>
<span id="cb140-308"><a href="#cb140-308"></a>  <span class="co"># This passes the new_priors specified above to brms</span></span>
<span id="cb140-309"><a href="#cb140-309"></a>  <span class="at">prior =</span> new_priors1_new,</span>
<span id="cb140-310"><a href="#cb140-310"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb140-311"><a href="#cb140-311"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit_1_new_priors"</span></span>
<span id="cb140-312"><a href="#cb140-312"></a>)</span>
<span id="cb140-313"><a href="#cb140-313"></a></span>
<span id="cb140-314"><a href="#cb140-314"></a>new_priors2_new <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb140-315"><a href="#cb140-315"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">coef =</span> <span class="st">"NoOfPools"</span>),</span>
<span id="cb140-316"><a href="#cb140-316"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb140-317"><a href="#cb140-317"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>,<span class="dv">1000</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb140-318"><a href="#cb140-318"></a>)</span>
<span id="cb140-319"><a href="#cb140-319"></a></span>
<span id="cb140-320"><a href="#cb140-320"></a></span>
<span id="cb140-321"><a href="#cb140-321"></a>fit_2_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb140-322"><a href="#cb140-322"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb140-323"><a href="#cb140-323"></a>  pres.abs <span class="sc">~</span> NoOfPools <span class="sc">+</span> meanmin <span class="sc">+</span> altitude,</span>
<span id="cb140-324"><a href="#cb140-324"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb140-325"><a href="#cb140-325"></a>  <span class="at">data =</span> data,</span>
<span id="cb140-326"><a href="#cb140-326"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb140-327"><a href="#cb140-327"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb140-328"><a href="#cb140-328"></a>  <span class="co"># This passes the new_priors specified above to brms</span></span>
<span id="cb140-329"><a href="#cb140-329"></a>  <span class="at">prior =</span> new_priors2_new,</span>
<span id="cb140-330"><a href="#cb140-330"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb140-331"><a href="#cb140-331"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit_2_new_priors_new_prior"</span></span>
<span id="cb140-332"><a href="#cb140-332"></a>)</span>
<span id="cb140-333"><a href="#cb140-333"></a></span>
<span id="cb140-334"><a href="#cb140-334"></a>new_priors3_new <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb140-335"><a href="#cb140-335"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">coef =</span> <span class="st">"meanmin"</span>),</span>
<span id="cb140-336"><a href="#cb140-336"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>,<span class="dv">1000</span>), <span class="at">coef =</span> <span class="st">"altitude"</span>)</span>
<span id="cb140-337"><a href="#cb140-337"></a>)</span>
<span id="cb140-338"><a href="#cb140-338"></a></span>
<span id="cb140-339"><a href="#cb140-339"></a>fit_3_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb140-340"><a href="#cb140-340"></a>  <span class="co"># This specifies the formula</span></span>
<span id="cb140-341"><a href="#cb140-341"></a>  pres.abs <span class="sc">~</span>  meanmin <span class="sc">+</span> altitude<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb140-342"><a href="#cb140-342"></a>  <span class="co"># This specifies the dataset</span></span>
<span id="cb140-343"><a href="#cb140-343"></a>  <span class="at">data =</span> data,</span>
<span id="cb140-344"><a href="#cb140-344"></a>  <span class="co"># This specifies the observation model family</span></span>
<span id="cb140-345"><a href="#cb140-345"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link=</span><span class="st">"logit"</span>),</span>
<span id="cb140-346"><a href="#cb140-346"></a>  <span class="co"># This passes the new_priors specified above to brms</span></span>
<span id="cb140-347"><a href="#cb140-347"></a>  <span class="at">prior =</span> new_priors3_new,</span>
<span id="cb140-348"><a href="#cb140-348"></a>  <span class="co"># This causes brms to cache the results</span></span>
<span id="cb140-349"><a href="#cb140-349"></a>  <span class="at">file =</span> <span class="st">"~/Documents/R/Project/fit_3_new_priors"</span></span>
<span id="cb140-350"><a href="#cb140-350"></a>)</span>
<span id="cb140-351"><a href="#cb140-351"></a></span>
<span id="cb140-352"><a href="#cb140-352"></a>pp_check_fit_1_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit_1_new_priors, <span class="st">"stat"</span>)</span>
<span id="cb140-353"><a href="#cb140-353"></a>traceplot_fit_1_new_priors <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit_1_new_priors, <span class="at">type =</span> <span class="st">"trace"</span>, <span class="at">prob=</span> <span class="fl">0.95</span>)</span>
<span id="cb140-354"><a href="#cb140-354"></a></span>
<span id="cb140-355"><a href="#cb140-355"></a>pp_check_fit_2_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit_2_new_priors, <span class="st">"stat"</span>)</span>
<span id="cb140-356"><a href="#cb140-356"></a>traceplot_fit_2_new_priors <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit_2_new_priors, <span class="at">type =</span> <span class="st">"trace"</span>)</span>
<span id="cb140-357"><a href="#cb140-357"></a></span>
<span id="cb140-358"><a href="#cb140-358"></a>pp_check_fit_3_new_priors <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(fit_3_new_priors, <span class="st">"stat"</span>)</span>
<span id="cb140-359"><a href="#cb140-359"></a>traceplot_fit_3_new_priors <span class="ot">&lt;-</span> <span class="fu">stanplot</span>(fit_3_new_priors, <span class="at">type =</span> <span class="st">"trace"</span>)</span>
<span id="cb140-360"><a href="#cb140-360"></a><span class="in">```</span></span>
<span id="cb140-361"><a href="#cb140-361"></a></span>
<span id="cb140-364"><a href="#cb140-364"></a><span class="in">```{r}</span></span>
<span id="cb140-365"><a href="#cb140-365"></a>s1_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_1_new_priors)</span>
<span id="cb140-366"><a href="#cb140-366"></a>s2_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_2_new_priors)</span>
<span id="cb140-367"><a href="#cb140-367"></a>s3_new <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_3_new_priors)</span>
<span id="cb140-368"><a href="#cb140-368"></a></span>
<span id="cb140-369"><a href="#cb140-369"></a><span class="fu">print</span>(s1_new)</span>
<span id="cb140-370"><a href="#cb140-370"></a><span class="fu">print</span>(s2_new)</span>
<span id="cb140-371"><a href="#cb140-371"></a><span class="fu">print</span>(s3_new)</span>
<span id="cb140-372"><a href="#cb140-372"></a></span>
<span id="cb140-373"><a href="#cb140-373"></a></span>
<span id="cb140-374"><a href="#cb140-374"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit_1_new_priors)</span>
<span id="cb140-375"><a href="#cb140-375"></a>r2_new <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit_2_new_priors)</span>
<span id="cb140-376"><a href="#cb140-376"></a>r3_new <span class="ot">&lt;-</span> <span class="fu">rhat</span>(fit_3_new_priors)</span>
<span id="cb140-377"><a href="#cb140-377"></a><span class="fu">print</span>(r1)</span>
<span id="cb140-378"><a href="#cb140-378"></a><span class="fu">print</span>(r2_new)</span>
<span id="cb140-379"><a href="#cb140-379"></a><span class="fu">print</span>(r3_new)</span>
<span id="cb140-380"><a href="#cb140-380"></a><span class="in">```</span></span>
<span id="cb140-381"><a href="#cb140-381"></a></span>
<span id="cb140-382"><a href="#cb140-382"></a></span>
<span id="cb140-383"><a href="#cb140-383"></a></span>
<span id="cb140-384"><a href="#cb140-384"></a></span>
<span id="cb140-387"><a href="#cb140-387"></a><span class="in">```{r}</span></span>
<span id="cb140-388"><a href="#cb140-388"></a>loo_fit_1_new_priors <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_1_new_priors)</span>
<span id="cb140-389"><a href="#cb140-389"></a>loo_fit_2_new_priors <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_2_new_priors)</span>
<span id="cb140-390"><a href="#cb140-390"></a>loo_fit_3_new_priors <span class="ot">&lt;-</span> <span class="fu">loo</span>(fit_3_new_priors)</span>
<span id="cb140-391"><a href="#cb140-391"></a></span>
<span id="cb140-392"><a href="#cb140-392"></a><span class="fu">loo_compare</span>(loo_fit_1_new_priors,loo_fit_2_new_priors,loo_fit_3_new_priors)</span>
<span id="cb140-393"><a href="#cb140-393"></a><span class="in">```</span></span>
<span id="cb140-394"><a href="#cb140-394"></a></span>
<span id="cb140-395"><a href="#cb140-395"></a></span>
<span id="cb140-398"><a href="#cb140-398"></a><span class="in">```{r}</span></span>
<span id="cb140-399"><a href="#cb140-399"></a><span class="fu">print</span>(pp_check_fit_1_new_priors)</span>
<span id="cb140-400"><a href="#cb140-400"></a><span class="fu">print</span>(pp_check_fit_2_new_priors)</span>
<span id="cb140-401"><a href="#cb140-401"></a><span class="fu">print</span>(pp_check_fit_3_new_priors)</span>
<span id="cb140-402"><a href="#cb140-402"></a><span class="fu">print</span>(traceplot_fit_1_new_priors)</span>
<span id="cb140-403"><a href="#cb140-403"></a><span class="fu">print</span>(traceplot_fit_2_new_priors)</span>
<span id="cb140-404"><a href="#cb140-404"></a><span class="fu">print</span>(traceplot_fit_3_new_priors)</span>
<span id="cb140-405"><a href="#cb140-405"></a></span>
<span id="cb140-406"><a href="#cb140-406"></a><span class="in">```</span></span>
<span id="cb140-407"><a href="#cb140-407"></a></span>
<span id="cb140-408"><a href="#cb140-408"></a></span>
<span id="cb140-409"><a href="#cb140-409"></a></span>
<span id="cb140-410"><a href="#cb140-410"></a></span>
<span id="cb140-413"><a href="#cb140-413"></a><span class="in">```{r}</span></span>
<span id="cb140-414"><a href="#cb140-414"></a><span class="fu">stancode</span>(fit1)</span>
<span id="cb140-415"><a href="#cb140-415"></a><span class="in">```</span></span>
<span id="cb140-416"><a href="#cb140-416"></a></span>
<span id="cb140-417"><a href="#cb140-417"></a></span>
<span id="cb140-420"><a href="#cb140-420"></a><span class="in">```{r}</span></span>
<span id="cb140-421"><a href="#cb140-421"></a><span class="fu">stancode</span>(fit2)</span>
<span id="cb140-422"><a href="#cb140-422"></a><span class="in">```</span></span>
<span id="cb140-423"><a href="#cb140-423"></a></span>
<span id="cb140-426"><a href="#cb140-426"></a><span class="in">```{r}</span></span>
<span id="cb140-427"><a href="#cb140-427"></a><span class="fu">stancode</span>(fit3)</span>
<span id="cb140-428"><a href="#cb140-428"></a><span class="in">```</span></span>
<span id="cb140-429"><a href="#cb140-429"></a></span>
<span id="cb140-430"><a href="#cb140-430"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>